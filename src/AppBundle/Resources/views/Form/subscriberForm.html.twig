{# src/AppBundle/Resources/views/Form/subscriberForm.html.twig #}
<div class="response"></div>

<form action="{{ path('subscribe', { '_locale': _locale }) }}" method="POST" {{ form_enctype(subscriberForm) }}>

    {{ form_widget(subscriberForm.email) }}

    {{ form_widget(subscriberForm._token) }}

    <button type="submit">
        <span>{{ 'subscriber.submit.label'|trans({}, "forms") }}</span>
    </button>

</form>

{% block javascripts %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
        $("form").submit(function(e) {

            e.preventDefault();

            $.ajax({
                type: $(this).attr("method"),
                url: $(this).attr("action"),
                data: $(this).serialize(),
                success: function(response) {
                    $('.response').html(response.message);
                },
                error: function(xhr, status, error) {
                    var error = JSON.parse(xhr.responseText);
                    $('.response').html(error.message);
                }
            });
        });
    </script>
{% endblock %}
